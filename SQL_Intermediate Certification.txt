
Q. A business is analyzing data by country. For each country, display the country name, total number of invoices, and their average amount. 
  Format the average as a floating-point number with 6 decimal places.
  Return only those countries where their average invoice amount is greater than the average invoice amount over all invoices.


SELECT c.country_name,count(*),avg(i.total_price)
from country c,city ci, invoice i, customer cu
WHERE c.id= ci.country_id and ci.id=cu.city_id and cu.id=i.customer_id
group BY c.country_name
having avg(i.total_price) > (select avg(total_price)from invoice);

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Q. For each pair of city and product, return the names of the city and product, as well the total amount spent on the product to 2 decimal places.
    Order the result by the amount spent from high to low then by cith name and product name in ascending order.


SELECT ci.city_name, pr.product_name, ROUND(SUM(ii.line_total_price), 2) AS tot
FROM city ci, customer cu, invoice i, invoice_item ii, product pr 
WHERE ci.id = cu.city_id AND cu.id = i.customer_id AND i.id = ii.invoice_id AND ii.product_id = pr.id 
GROUP BY ci.city_name, pr.product_name 
ORDER BY tot DESC, ci.city_name, pr.product_name 